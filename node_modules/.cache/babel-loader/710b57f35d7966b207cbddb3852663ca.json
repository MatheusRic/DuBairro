{"ast":null,"code":"var _jsxFileName = \"/home/matheus/Documentos/Kenzie/M3/Project-Frontend-M3/Projeto M3/frontend/src/Context/AuthContext.js\",\n    _s = $RefreshSig$();\n\nimport { toast } from \"react-toastify\";\nimport React, { createContext, useEffect, useState } from \"react\";\nimport Api from \"../Services/api\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Context = /*#__PURE__*/createContext();\n\nfunction AuthProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [authenticated, setAuthenticated] = useState(false);\n  const [isOpenModalLogin, setIsOpenModalLogin] = useState(false);\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    const Token = localStorage.getItem(\"@User:Token\");\n\n    if (Token) {\n      Api.defaults.headers.common[\"Authorization\"] = `Bearer ${JSON.parse(Token)}`;\n      setAuthenticated(true);\n      setLoading(false);\n    }\n  }, []);\n\n  async function handleLogin(userData) {\n    const {\n      data: {\n        accessToken,\n        user\n      }\n    } = await Api.post(\"/login\", userData).catch(err => {\n      toast.error(\"Email ou senha inválido!\");\n    });\n\n    if (user) {\n      toast.success(\"login feito com sucesso!\");\n    }\n\n    localStorage.setItem(\"@User:Token\", JSON.stringify(accessToken));\n    localStorage.setItem(\"@User:Data\", JSON.stringify(user));\n    Api.defaults.headers.common[\"Authorization\"] = `Bearer ${accessToken}`;\n    navigate(\"/profile\", {\n      replace: true\n    });\n    setAuthenticated(true);\n  }\n\n  function handleLogout() {\n    setAuthenticated(false);\n    localStorage.removeItem(\"@User:Token\");\n    localStorage.removeItem(\"@User:Data\");\n    Api.defaults.headers.common[\"Authorization\"] = null;\n    navigate(\"/home\", {\n      replace: true\n    });\n  }\n\n  const [inputCidade, setInputCidade] = useState(\"\");\n  const [categoria, setCategoria] = useState(\"\");\n  const [lojas, setLojas] = useState([]);\n  useEffect(() => {\n    Api.get(\"/users\").then(_ref2 => {\n      let {\n        data\n      } = _ref2;\n\n      /* console.log(data.city); */\n      if (inputCidade === \"\" && categoria === \"\") {\n        return setLojas(data);\n      } else if (inputCidade !== \"\") {\n        const filter = data.filter(element => element.city.toLowerCase().includes(inputCidade.toLowerCase()) || element.district.toLowerCase().includes(inputCidade.toLowerCase()));\n        return setLojas(filter);\n      } else {\n        const filter = data.filter(element => {\n          return categoria.toLowerCase().includes(element.category.toLowerCase());\n        });\n        return setLojas(filter);\n      }\n    }).catch(errors => console.log(errors));\n  }, [inputCidade, categoria, lojas]);\n  return /*#__PURE__*/_jsxDEV(Context.Provider, {\n    value: {\n      authenticated,\n      handleLogin,\n      handleLogout,\n      setCategoria,\n      setInputCidade,\n      lojas,\n      setIsOpenModalLogin,\n      isOpenModalLogin\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AuthProvider, \"ntGJd/uY5nEZEThSBbkuLzshwak=\", false, function () {\n  return [useNavigate];\n});\n\n_c = AuthProvider;\nexport { Context, AuthProvider };\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["toast","React","createContext","useEffect","useState","Api","useNavigate","Context","AuthProvider","children","authenticated","setAuthenticated","isOpenModalLogin","setIsOpenModalLogin","navigate","loading","setLoading","Token","localStorage","getItem","defaults","headers","common","JSON","parse","handleLogin","userData","data","accessToken","user","post","catch","err","error","success","setItem","stringify","replace","handleLogout","removeItem","inputCidade","setInputCidade","categoria","setCategoria","lojas","setLojas","get","then","filter","element","city","toLowerCase","includes","district","category","errors","console","log"],"sources":["/home/matheus/Documentos/Kenzie/M3/Project-Frontend-M3/Projeto M3/frontend/src/Context/AuthContext.js"],"sourcesContent":["import { toast } from \"react-toastify\";\nimport React, { createContext, useEffect, useState } from \"react\";\nimport Api from \"../Services/api\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst Context = createContext();\n\nfunction AuthProvider({ children }) {\n  const [authenticated, setAuthenticated] = useState(false);\n  const [isOpenModalLogin, setIsOpenModalLogin] = useState(false);\n\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const Token = localStorage.getItem(\"@User:Token\");\n    \n    if (Token) {\n      Api.defaults.headers.common[\"Authorization\"] = `Bearer ${JSON.parse(\n        Token\n      )}`;\n      setAuthenticated(true);\n      setLoading(false);\n    }\n  }, []);\n\n  async function handleLogin(userData) {\n    const {\n      data: { accessToken, user },\n    } = await Api.post(\"/login\", userData).catch((err) => {\n      toast.error(\"Email ou senha inválido!\");\n    });\n    if (user) {\n      toast.success(\"login feito com sucesso!\");\n    }\n\n    localStorage.setItem(\"@User:Token\", JSON.stringify(accessToken));\n    localStorage.setItem(\"@User:Data\", JSON.stringify(user));\n\n    Api.defaults.headers.common[\"Authorization\"] = `Bearer ${accessToken}`;\n    navigate(\"/profile\", { replace: true });\n    setAuthenticated(true);\n  }\n\n  function handleLogout() {\n    setAuthenticated(false);\n    localStorage.removeItem(\"@User:Token\");\n    localStorage.removeItem(\"@User:Data\");\n\n    Api.defaults.headers.common[\"Authorization\"] = null;\n    navigate(\"/home\", { replace: true });\n  }\n\n  const [inputCidade, setInputCidade] = useState(\"\");\n  const [categoria, setCategoria] = useState(\"\");\n  const [lojas, setLojas] = useState([]);\n\n  useEffect(() => {\n    Api.get(\"/users\")\n      .then(({ data }) => {\n        /* console.log(data.city); */\n        if (inputCidade === \"\" && categoria === \"\") {\n          return setLojas(data);\n        } else if (inputCidade !== \"\") {\n          const filter = data.filter(\n            (element) =>\n              element.city.toLowerCase().includes(inputCidade.toLowerCase()) ||\n              element.district.toLowerCase().includes(inputCidade.toLowerCase())\n          );\n          return setLojas(filter);\n        } else {\n          const filter = data.filter((element) => {\n            return categoria\n              .toLowerCase()\n              .includes(element.category.toLowerCase());\n          });\n          return setLojas(filter);\n        }\n      })\n      .catch((errors) => console.log(errors));\n  }, [inputCidade, categoria, lojas]);\n\n  return (\n    <Context.Provider\n      value={{\n        authenticated,\n        handleLogin,\n        handleLogout,\n        setCategoria,\n        setInputCidade,\n        lojas,\n        setIsOpenModalLogin,\n        isOpenModalLogin,\n      }}>\n      {children}\n    </Context.Provider>\n  );\n}\n\nexport { Context, AuthProvider };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}